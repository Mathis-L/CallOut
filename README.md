# Call Out ü´µ - Jeu Multijoueur en Temps R√©el

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

<p align="center">
  <img src="screenshots/LogoCallOut.png" alt="Logo" width="150"/>
</p>

**Call Out ü´µ** est une application web multijoueur gratuite con√ßue pour animer vos soir√©es entre amis avec des votes interactifs du type "Qui de nous est le plus susceptible de...". D√©velopp√©e avec **Google Apps Script** et **Firebase Realtime Database**, elle fonctionne en temps r√©el sans serveur backend d√©di√©.

üöÄ Pourquoi ce projet est sp√©cial :
*   Il d√©montre qu'on peut cr√©er une **web app complexe et gratuite** avec des outils accessibles.
*   Le syst√®me de **lobby multijoueur** permet d'accueillir plusieurs joueurs et peut facilement servir de base √† d'autres jeux en ligne.
*   Une **exp√©rience fluide en temps r√©el** gr√¢ce √† Firebase : synchronisation des votes, avatars personnalisables, animation de lancer de pi√®ce, etc.

üìö Ce projet m‚Äôa permis d‚Äôapprendre √† d√©velopper un jeu en temps r√©el sur le web, √† g√©rer des connexions multiples et √† concevoir une interface interactive sans utiliser de backend lourd.

üß™ L‚Äôapp est testable en ligne via [D√©mo Call Out](https://script.google.com/macros/s/AKfycbzozmc1IhN_cuT7p9ccirAdfpFzP7ho6fqVRQ8WU9yNMrdYGtIWYwvt83eTTrYhM38S/exec), et peut √™tre facilement h√©berg√©e par n‚Äôimporte qui en suivant les instructions de ce README.

<p align="center">
  <img src="screenshots/Splash screen.png" alt="Spalsh Screen"/>
</p>

## ‚ú® Fonctionnalit√©s Principales

*   **Jeu Multijoueur en Temps R√©el:** Synchronisation de l'√©tat du jeu entre tous les participants via Firebase.
*   **Syst√®me de Lobby:** Cr√©ation et jonction de parties via des codes uniques.
*   **M√©canisme de Vote Interactif:** Les joueurs votent pour r√©pondre √† des questions concernant les autres participants.
*   **Sets de Questions Th√©matiques:** Le leader de la partie peut choisir parmi diff√©rents ensembles de questions (Gentil, Mix, Extr√™me).
*   **Lancer de Pi√®ce Anim√©:** Introduit un √©l√©ment de hasard pour la r√©v√©lation des votes.
*   **Avatars Personnalisables:** Les joueurs peuvent choisir un avatar pour les repr√©senter.
*   **Gestion de la Pr√©sence des Joueurs:** D√©tection des connexions et d√©connexions.
*   **D√©ploiement Enti√®rement Gratuit:** H√©berg√© sur la plateforme Google Apps Script.
*   **Extensibilit√©:** Facilit√© d'ajout de nouvelles questions et d'avatars.

## üõ†Ô∏è Architecture Technique

*   **Backend:** Google Apps Script (GAS)
*   **Base de Donn√©es:** Firebase Realtime Database
*   **Frontend:** HTML, CSS, JavaScript (Vanilla)
*   **Configuration:** Google Apps Script PropertiesService

## üìÇ Structure du D√©p√¥t

Ce d√©p√¥t est organis√© comme suit :

*   **/GAS**: Contient tous les fichiers de code destin√©s √† √™tre d√©ploy√©s sur Google Apps Script.
    *   `Code.gs`: Script principal du backend.
    *   `HomePage.html`, `LobbyPage.html`, `GamePage.html`: Pages HTML pour l'interface utilisateur.
    *   `GamePage.css.html`: Styles CSS pour la page de jeu.
    *   `GamePage.js.html`: Scripts JavaScript c√¥t√© client pour la page du jeu.
    *   `Questions.html`: Fichier HTML contenant la liste des questions du jeu.
    *   `AvatarData.html`: Fichier HTML contenant la liste des avatars (g√©n√©r√© ou configur√© manuellement).
*   **/Scripts**: Comprend le script Python utilitaire pour la g√©n√©ration d'avatars.
    *   `generate_avatars.py`: Script pour convertir des images PNG en format Base64 et g√©n√©rer le fichier `AvatarData.html`.
    *   `requirements.txt`: Liste des d√©pendances Python pour le script `generate_avatars.py`.
*   **/Avatars**: Dossier destin√© √† contenir les images PNG sources pour la g√©n√©ration d'avatars via le script Python. (Ce dossier peut √™tre initialement vide ou contenir des exemples).

## üöÄ Guide de D√©ploiement

Pour d√©ployer votre propre instance de Call Out ü´µ, suivez ces √©tapes :

**1. Pr√©requis:**

*   Un compte Google.
*   Un projet Firebase actif ([firebase.google.com](https://firebase.google.com/)).
*   Python 3.x install√© localement (si vous souhaitez utiliser le script de g√©n√©ration d'avatars).
*   Git (pour cloner ce d√©p√¥t). (si vous souhaitez utiliser le script de g√©n√©ration d'avatars).

**2. Configuration de Firebase:**

*   Cr√©ez un nouveau projet Firebase ou utilisez un projet existant.
*   Activez et configurez **Realtime Database**.
    *   Lors de la cr√©ation, choisissez une r√©gion appropri√©e.
    *   **R√®gles de S√©curit√© (Important):** Pour le d√©veloppement initial, vous pouvez utiliser des r√®gles ouvertes. **Ces r√®gles ne sont PAS S√âCURIS√âES pour un environnement de production.**
        ```json
        {
          "rules": {
            ".read": true,
            ".write": true
          }
        }
        ```
        *Il est fortement recommand√© d'impl√©menter l'authentification Firebase et des r√®gles de s√©curit√© granulaires pour la production.*
*   Dans les **Param√®tres du projet** > **G√©n√©ral**, enregistrez une nouvelle **application Web**.
    *   Ne cochez PAS "Configurer √©galement Firebase Hosting...".
*   Copiez l'objet de configuration `firebaseConfig` fourni. Vous aurez besoin des valeurs `apiKey`, `authDomain`, `databaseURL`, et `projectId`.

**3. Configuration de Google Apps Script:**

*   Cr√©ez un nouveau projet sur [script.google.com](https://script.google.com/).
*   Copiez le contenu des fichiers du dossier `/GAS` de ce d√©p√¥t dans les fichiers correspondants de votre projet Apps Script. (Cr√©ez les fichiers HTML s'ils n'existent pas via `Fichier > Nouveau > Fichier HTML`).
*   Configurez les **Propri√©t√©s du script** (Param√®tres du projet ‚öôÔ∏è > Propri√©t√©s du script (en bas de page)) avec vos cl√©s Firebase :
    *   `FIREBASE_API_KEY`
    *   `FIREBASE_AUTH_DOMAIN`
    *   `FIREBASE_DATABASE_URL`
    *   `FIREBASE_PROJECT_ID`
*   Enregistrez les propri√©t√©s.

**4. D√©ploiement de l'Application Web:**

*   Dans l'√©diteur Apps Script, cliquez sur **D√©ployer** > **Nouveau d√©ploiement**.
*   Type de d√©ploiement : **Application Web**.
*   Configurez :
    *   **Ex√©cuter en tant que:** `Moi`.
    *   **Qui a acc√®s:** `Tout le monde`. (pour que vos amis puissent se connecter)
*   Cliquez sur **D√©ployer**.
*   Autorisez les permissions requises par le script.
*   Copiez l'**URL de l'application Web** fournie. C'est l'URL d'acc√®s √† votre jeu. (Partagez le avec vos amis !)

**(Optionnel) Configuration du D√©clencheur pour Nettoyage Automatique:**  
La gestion des suppressions de lobby dans la base de donn√©e est pas fiable donc pour palier √† ce probl√®me et nettoyer la base de donn√©e j'utilise l'API REST de Firebase Realtime Database, cependant cette m√©thode est **d√©conseill√© et opsol√®te** :
*   G√©n√©rer une `FIREBASE_DATABASE_ID` :
    *   Dans votre projet firebase cliquer sur Param√®tres du projet ‚öôÔ∏è sur la gauche > Comptes de service > Secrets de la base de donn√©es > afficher le Secret.
*   Configurez GAS :
    *    **Propri√©t√©s du script** (Param√®tres du projet ‚öôÔ∏è > Propri√©t√©s du script (en bas de page)) avec `FIREBASE_DATABASE_ID`
    *   Pour ex√©cuter la fonction `cleanUpLobbies` p√©riodiquement (ex: tout les lundis matin) :
        *   Dans l'√©diteur Apps Script, allez √† la section **D√©clencheurs** (ic√¥ne ‚è∞).
        *   Cliquez sur **Ajouter un d√©clencheur**.
        *   Configurez pour ex√©cuter `cleanUpLobbies` sur un √©v√©nement `Temporel` (ex: `Minuteur horaire`).

## üîß Personnalisation

**1. Ajouter ou Modifier des Questions:**

*   Modifiez le fichier `Questions.html` (situ√© dans `/GAS` pour le d√©ploiement) en ajoutant ou modifiant les cha√Ænes de caract√®res dans les tableaux `gentleQuestions`, `mixQuestions`, ou `extremeQuestions`.
*   Apr√®s toute modification, **red√©ployez** votre application Web Apps Script (D√©ployer > G√©rer les d√©ploiements > choisissez votre d√©ploiement > Modifier ‚úèÔ∏è > Nouvelle version & Description (optionnel)> D√©ployer).

**2. Ajouter ou Modifier des Avatars:**

*   **M√©thode 1: Utilisation d'URLs Publiques (Recommand√© pour la simplicit√©)**
    *   Ouvrez le fichier `AvatarData.html` (dans `/GAS`).
    *   Modifiez ou ajoutez des objets au tableau JavaScript `AVATAR_LIST`. Chaque objet doit avoir la structure suivante : `{ name: "Nom de l'avatar", src: "URL_PUBLIQUE_DE_L_IMAGE.png" }`.
    *   Assurez-vous que les URLs pointent directement vers des fichiers image (.png, .jpg, .gif, .svg) accessibles publiquement.
    *   **Red√©ployez** votre application Apps Script apr√®s modification.

*   **M√©thode 2: G√©n√©ration d'Avatars Personnalis√©s avec IA et Python (Local)**
    1.  **Pr√©paration (localement):**
        *   Clonez ce d√©p√¥t GitHub sur votre machine.
        *   Naviguez vers le dossier `/Scripts`.
        *   Installez les d√©pendances Python : `pip install -r requirements.txt` (cela installera `Pillow`).
    2.  **Cr√©ation d'Avatars avec IA :**
        *   Obtenez une image de la personne pour laquelle vous souhaitez cr√©er un avatar.
        *   Utilisez ChatGPT pour g√©n√©rer une image, en donnant l'image de la personne et en √©crivant un prompt tel que :
            `"Generate a high-quality chibi-style sticker of this person with a transparent background."` (note: chibi-style cr√©er des stickers mignon, libre √† vous de choisir un autre style, graffiti art, comic, caricature in pixar style ...)
        *   T√©l√©chargez l'image g√©n√©r√©e (assurez-vous qu'elle soit au format `.png` et avec un fond transparent si possible).
    3.  **Organisation des Fichiers:**
        *   Placez toutes les images PNG que vous souhaitez utiliser comme avatars dans le dossier `/Avatars` de votre copie locale du d√©p√¥t.
    4.  **Ex√©cution du Script Python:**
        *   Depuis le dossier racine de votre copie locale du d√©p√¥t, ex√©cutez le script `generate_avatars.py` en sp√©cifiant le dossier `/Avatars` :
            ```bash
            python Scripts/generate_avatars.py
            ```
        *   Le script traitera chaque image PNG dans le dossier `/Avatars`, la redimensionnera en 128x128, la convertira en une cha√Æne Base64, et g√©n√©rera un fichier nomm√© `avatars_output.txt` √† la racine du dossier `/Avatars`. Ce fichier contiendra la structure JavaScript `AVATAR_LIST` pr√™te √† l'emploi.
    5.  **Int√©gration dans GAS:**
        *   Ouvrez le fichier `Avatars/avatars_output.txt` g√©n√©r√©.
        *   Copiez **l'int√©gralit√© de son contenu** (CTRL+A > CTRL+C).
        *   Dans votre projet Google Apps Script, ouvrez le fichier `AvatarData.html`.
        *   **Remplacez** le contenu existant du fichier `AvatarData.html` (CTRL+A > CTRL+V) par le contenu que vous venez de copier.
    6.  **Red√©ploiement:**
        *   **Red√©ployez** votre application Web Apps Script pour que les nouveaux avatars soient pris en compte.

## üéÆ Comment Jouer

1.  Acc√©dez √† l'URL de l'application Web que vous avez d√©ploy√©e.
2.  Entrez un pseudo et s√©lectionnez un avatar.
3.  **Pour cr√©er une partie:** Cliquez sur "Cr√©er une Partie" et partagez le code de partie g√©n√©r√©.
4.  **Pour rejoindre une partie:** Entrez votre pseudo, choisissez un avatar, saisissez le code de partie fourni, et cliquez sur "Rejoindre une Partie".
5.  Dans le **lobby**, attendez les autres joueurs. Le leader de la partie (cr√©ateur) peut s√©lectionner le set de questions et d√©marrer le jeu.
6.  Pendant la phase de **vote**, s√©lectionnez l'avatar du joueur qui, selon vous, correspond le mieux √† la question affich√©e.
7.  Consultez les **r√©sultats** pour voir qui a re√ßu le plus de votes.
8.  Le **lancer de pi√®ce** d√©terminera si les noms des votants pour un joueur sp√©cifique sont r√©v√©l√©s.
9.  Cliquez sur "Pr√™t pour la prochaine manche" pour continuer. Le jeu progresse lorsque tous les joueurs connect√©s sont pr√™ts.
10. Utilisez le bouton "Quitter" pour vous d√©connecter de la partie ou du lobby.

## üìÑ Licence

Ce projet est distribu√© sous la licence MIT. Pour plus de d√©tails, veuillez consulter le fichier `LICENSE` dans ce d√©p√¥t.